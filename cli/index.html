<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://www.jkobject.com/scPRINT/cli/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>cli - scprint</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "cli";
        var mkdocs_page_input_path = "cli.md";
        var mkdocs_page_url = "/scPRINT/cli/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> scprint
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../structure/">structure</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../pretrain/">pre-training</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../usage/">usage example</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">example notebooks</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../notebooks/cancer_usecase/">Cancer usecase</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../notebooks/cancer_usecase_part2/">Cancer usecase (part 2)</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">documentation</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../model/">model</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tasks/">tasks</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">cli</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#scprint.__main__">__main__</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#scprint.__main__.MySaveConfig">MySaveConfig</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#scprint.cli">cli</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#scprint.cli.MyCLI">MyCLI</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#scprint.trainer.trainer">trainer</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#scprint.trainer.trainer.TrainingMode">TrainingMode</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../embedder/">embedders</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../utils/">utils</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">scprint</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">documentation</li>
      <li class="breadcrumb-item active">cli</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="documentation-for-the-cli-modules">Documentation for the <code>cli</code> modules</h1>


<div class="doc doc-object doc-module">



<h2 id="scprint.__main__" class="doc doc-heading">
            <code>scprint.__main__</code>


</h2>

    <div class="doc doc-contents first">

      <p>Entry point for scprint.</p>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="scprint.__main__.MySaveConfig" class="doc doc-heading">
            <code>MySaveConfig</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="lightning.pytorch.cli.SaveConfigCallback">SaveConfigCallback</span></code></p>


      <p>MySaveConfig is a subclass of SaveConfigCallback to parametrize the wandb logger further in cli mode</p>




  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="scprint.cli" class="doc doc-heading">
            <code>scprint.cli</code>


</h2>

    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="scprint.cli.MyCLI" class="doc doc-heading">
            <code>MyCLI</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="lightning.pytorch.cli.LightningCLI">LightningCLI</span></code></p>


      <p>MyCLI is a subclass of LightningCLI to add some missing params and create bindings between params of the model and the data.</p>
<p>Used to allow calling denoise / embed / gninfer from the command line.
Also to add more parameters and link parameters between the scdataloader and the scPRINT model.</p>




  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="scprint.trainer.trainer" class="doc doc-heading">
            <code>scprint.trainer.trainer</code>


</h2>

    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="scprint.trainer.trainer.TrainingMode" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">TrainingMode</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="lightning.pytorch.callbacks.Callback">Callback</span></code></p>


      <p>TrainingMode a callback to set the training specific info to the model.</p>
<p>This is because lightning is unfortunately setup this way. the model should be separated from training
but at the same time it has training specific methods... so we have to do this.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>do_denoise</code></b>
                  (<code>bool</code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to apply denoising during training. Defaults to True.</p>
              </div>
            </li>
            <li>
              <b><code>noise</code></b>
                  (<code><span title="typing.List">List</span>[float]</code>, default:
                      <code>[0.6]</code>
)
              –
              <div class="doc-md-description">
                <p>List of noise levels to apply if denoising is enabled. Defaults to [0.6], meaning only one forward path with 60% of the counts being dropped will happen.</p>
              </div>
            </li>
            <li>
              <b><code>do_cce</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to apply the Contrastive Cell Embedding from scGPT during training. Defaults to False.</p>
              </div>
            </li>
            <li>
              <b><code>cce_sim</code></b>
                  (<code>float</code>, default:
                      <code>0.5</code>
)
              –
              <div class="doc-md-description">
                <p>Similarity threshold for CCE. Defaults to 0.5.</p>
              </div>
            </li>
            <li>
              <b><code>cce_scale</code></b>
                  (<code>float</code>, default:
                      <code>0.002</code>
)
              –
              <div class="doc-md-description">
                <p>Scaling factor for CCE loss. Defaults to 0.002.</p>
              </div>
            </li>
            <li>
              <b><code>do_ecs</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to apply the Elastic Cell Similarity loss from scGPT during training. Defaults to False.</p>
              </div>
            </li>
            <li>
              <b><code>ecs_threshold</code></b>
                  (<code>float</code>, default:
                      <code>0.3</code>
)
              –
              <div class="doc-md-description">
                <p>Threshold for ECS. Defaults to 0.3.</p>
              </div>
            </li>
            <li>
              <b><code>ecs_scale</code></b>
                  (<code>float</code>, default:
                      <code>0.05</code>
)
              –
              <div class="doc-md-description">
                <p>Scaling factor for ECS loss. Defaults to 0.05.</p>
              </div>
            </li>
            <li>
              <b><code>do_mvc</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to do the cell embedding generation with the scGPT's MVC loss. Defaults to False.</p>
              </div>
            </li>
            <li>
              <b><code>mvc_scale</code></b>
                  (<code>float</code>, default:
                      <code>1.0</code>
)
              –
              <div class="doc-md-description">
                <p>Scaling factor for MVC loss. Defaults to 1.0.</p>
              </div>
            </li>
            <li>
              <b><code>do_adv_cls</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to apply adversarial classification during training. Defaults to False.</p>
              </div>
            </li>
            <li>
              <b><code>do_generate</code></b>
                  (<code>bool</code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to do the bottleneck learning task. Defaults to True.</p>
              </div>
            </li>
            <li>
              <b><code>class_scale</code></b>
                  (<code>float</code>, default:
                      <code>1.5</code>
)
              –
              <div class="doc-md-description">
                <p>Scaling factor for classification loss. Defaults to 1.5.</p>
              </div>
            </li>
            <li>
              <b><code>mask_ratio</code></b>
                  (<code><span title="typing.List">List</span>[float]</code>, default:
                      <code>[]</code>
)
              –
              <div class="doc-md-description">
                <p>List of mask ratios to apply during training. Defaults to [], meaning no masking is applied during pretraining.</p>
              </div>
            </li>
            <li>
              <b><code>warmup_duration</code></b>
                  (<code>int</code>, default:
                      <code>500</code>
)
              –
              <div class="doc-md-description">
                <p>Number of warmup steps for learning rate scheduling. Defaults to 500.</p>
              </div>
            </li>
            <li>
              <b><code>fused_adam</code></b>
                  (<code>bool</code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to use fused Adam optimizer. Defaults to True.</p>
              </div>
            </li>
            <li>
              <b><code>adv_class_scale</code></b>
                  (<code>float</code>, default:
                      <code>0.1</code>
)
              –
              <div class="doc-md-description">
                <p>Scaling factor for adversarial classification loss. Defaults to 0.1.</p>
              </div>
            </li>
            <li>
              <b><code>lr_reduce_patience</code></b>
                  (<code>int</code>, default:
                      <code>1</code>
)
              –
              <div class="doc-md-description">
                <p>Number of epochs with no improvement after which learning rate will be reduced. Defaults to 1.</p>
              </div>
            </li>
            <li>
              <b><code>lr_reduce_factor</code></b>
                  (<code>float</code>, default:
                      <code>0.6</code>
)
              –
              <div class="doc-md-description">
                <p>Factor by which the learning rate will be reduced. Defaults to 0.6.</p>
              </div>
            </li>
            <li>
              <b><code>lr_reduce_monitor</code></b>
                  (<code>str</code>, default:
                      <code>&#39;val_loss&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Quantity to be monitored for learning rate reduction. Defaults to "val_loss".</p>
              </div>
            </li>
            <li>
              <b><code>do_cls</code></b>
                  (<code>bool</code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to perform classification during training. Defaults to True.</p>
              </div>
            </li>
            <li>
              <b><code>do_adv_batch</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to apply adversarial batch training. Defaults to False.</p>
              </div>
            </li>
            <li>
              <b><code>run_full_forward</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to run a second forward pass without masking or denoising for the bottleneck learning / MVC case. Defaults to False.</p>
              </div>
            </li>
            <li>
              <b><code>lr</code></b>
                  (<code>float</code>, default:
                      <code>0.001</code>
)
              –
              <div class="doc-md-description">
                <p>Initial learning rate. Defaults to 0.001.</p>
              </div>
            </li>
            <li>
              <b><code>optim</code></b>
                  (<code>str</code>, default:
                      <code>&#39;adamW&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Optimizer to use during training. Defaults to "adamW".</p>
              </div>
            </li>
            <li>
              <b><code>weight_decay</code></b>
                  (<code>float</code>, default:
                      <code>0.01</code>
)
              –
              <div class="doc-md-description">
                <p>Weight decay to apply during optimization. Defaults to 0.01.</p>
              </div>
            </li>
            <li>
              <b><code>name</code></b>
                  (<code>str</code>, default:
                      <code>&#39;&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Name of the training mode. Defaults to an empty string. should be an ID for the model</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
                  <details class="quote">
                    <summary>Source code in <code>scprint/trainer/trainer.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">do_denoise</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">noise</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">],</span>
    <span class="n">do_cce</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">cce_sim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># .6</span>
    <span class="n">cce_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.002</span><span class="p">,</span>  <span class="c1"># .01</span>
    <span class="n">do_ecs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">ecs_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="n">ecs_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>  <span class="c1"># .1</span>
    <span class="n">do_mvc</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">mvc_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">do_adv_cls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">do_next_tp</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">do_generate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">class_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span>
    <span class="n">mask_ratio</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>  <span class="c1"># 0.3</span>
    <span class="n">warmup_duration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="n">fused_adam</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">adv_class_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="n">lr_reduce_patience</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">lr_reduce_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span>
    <span class="n">lr_reduce_monitor</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;val_loss&quot;</span><span class="p">,</span>
    <span class="n">do_cls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">do_adv_batch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">run_full_forward</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">lr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span>
    <span class="n">optim</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;adamW&quot;</span><span class="p">,</span>
    <span class="n">weight_decay</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    TrainingMode a callback to set the training specific info to the model.</span>

<span class="sd">    This is because lightning is unfortunately setup this way. the model should be separated from training</span>
<span class="sd">    but at the same time it has training specific methods... so we have to do this.</span>

<span class="sd">    Args:</span>
<span class="sd">        do_denoise (bool): Whether to apply denoising during training. Defaults to True.</span>
<span class="sd">        noise (List[float]): List of noise levels to apply if denoising is enabled. Defaults to [0.6], meaning only one forward path with 60% of the counts being dropped will happen.</span>
<span class="sd">        do_cce (bool): Whether to apply the Contrastive Cell Embedding from scGPT during training. Defaults to False.</span>
<span class="sd">        cce_sim (float): Similarity threshold for CCE. Defaults to 0.5.</span>
<span class="sd">        cce_scale (float): Scaling factor for CCE loss. Defaults to 0.002.</span>
<span class="sd">        do_ecs (bool): Whether to apply the Elastic Cell Similarity loss from scGPT during training. Defaults to False.</span>
<span class="sd">        ecs_threshold (float): Threshold for ECS. Defaults to 0.3.</span>
<span class="sd">        ecs_scale (float): Scaling factor for ECS loss. Defaults to 0.05.</span>
<span class="sd">        do_mvc (bool): Whether to do the cell embedding generation with the scGPT&#39;s MVC loss. Defaults to False.</span>
<span class="sd">        mvc_scale (float): Scaling factor for MVC loss. Defaults to 1.0.</span>
<span class="sd">        do_adv_cls (bool): Whether to apply adversarial classification during training. Defaults to False.</span>
<span class="sd">        do_generate (bool): Whether to do the bottleneck learning task. Defaults to True.</span>
<span class="sd">        class_scale (float): Scaling factor for classification loss. Defaults to 1.5.</span>
<span class="sd">        mask_ratio (List[float]): List of mask ratios to apply during training. Defaults to [], meaning no masking is applied during pretraining.</span>
<span class="sd">        warmup_duration (int): Number of warmup steps for learning rate scheduling. Defaults to 500.</span>
<span class="sd">        fused_adam (bool): Whether to use fused Adam optimizer. Defaults to True.</span>
<span class="sd">        adv_class_scale (float): Scaling factor for adversarial classification loss. Defaults to 0.1.</span>
<span class="sd">        lr_reduce_patience (int): Number of epochs with no improvement after which learning rate will be reduced. Defaults to 1.</span>
<span class="sd">        lr_reduce_factor (float): Factor by which the learning rate will be reduced. Defaults to 0.6.</span>
<span class="sd">        lr_reduce_monitor (str): Quantity to be monitored for learning rate reduction. Defaults to &quot;val_loss&quot;.</span>
<span class="sd">        do_cls (bool): Whether to perform classification during training. Defaults to True.</span>
<span class="sd">        do_adv_batch (bool): Whether to apply adversarial batch training. Defaults to False.</span>
<span class="sd">        run_full_forward (bool): Whether to run a second forward pass without masking or denoising for the bottleneck learning / MVC case. Defaults to False.</span>
<span class="sd">        lr (float): Initial learning rate. Defaults to 0.001.</span>
<span class="sd">        optim (str): Optimizer to use during training. Defaults to &quot;adamW&quot;.</span>
<span class="sd">        weight_decay (float): Weight decay to apply during optimization. Defaults to 0.01.</span>
<span class="sd">        name (str): Name of the training mode. Defaults to an empty string. should be an ID for the model</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">do_denoise</span> <span class="o">=</span> <span class="n">do_denoise</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">noise</span> <span class="o">=</span> <span class="n">noise</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">do_cce</span> <span class="o">=</span> <span class="n">do_cce</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cce_sim</span> <span class="o">=</span> <span class="n">cce_sim</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cce_scale</span> <span class="o">=</span> <span class="n">cce_scale</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">do_ecs</span> <span class="o">=</span> <span class="n">do_ecs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ecs_threshold</span> <span class="o">=</span> <span class="n">ecs_threshold</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ecs_scale</span> <span class="o">=</span> <span class="n">ecs_scale</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">do_mvc</span> <span class="o">=</span> <span class="n">do_mvc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">do_adv_cls</span> <span class="o">=</span> <span class="n">do_adv_cls</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">do_next_tp</span> <span class="o">=</span> <span class="n">do_next_tp</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">do_generate</span> <span class="o">=</span> <span class="n">do_generate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">class_scale</span> <span class="o">=</span> <span class="n">class_scale</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mask_ratio</span> <span class="o">=</span> <span class="n">mask_ratio</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">warmup_duration</span> <span class="o">=</span> <span class="n">warmup_duration</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fused_adam</span> <span class="o">=</span> <span class="n">fused_adam</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mvc_scale</span> <span class="o">=</span> <span class="n">mvc_scale</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">do_cls</span> <span class="o">=</span> <span class="n">do_cls</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">adv_class_scale</span> <span class="o">=</span> <span class="n">adv_class_scale</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lr_reduce_patience</span> <span class="o">=</span> <span class="n">lr_reduce_patience</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lr_reduce_factor</span> <span class="o">=</span> <span class="n">lr_reduce_factor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lr_reduce_monitor</span> <span class="o">=</span> <span class="n">lr_reduce_monitor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lr</span> <span class="o">=</span> <span class="n">lr</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">optim</span> <span class="o">=</span> <span class="n">optim</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">weight_decay</span> <span class="o">=</span> <span class="n">weight_decay</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">do_cls</span> <span class="o">=</span> <span class="n">do_cls</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">do_adv_batch</span> <span class="o">=</span> <span class="n">do_adv_batch</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">run_full_forward</span> <span class="o">=</span> <span class="n">run_full_forward</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../tasks/" class="btn btn-neutral float-left" title="tasks"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../embedder/" class="btn btn-neutral float-right" title="embedders">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../tasks/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../embedder/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
